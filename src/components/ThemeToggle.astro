---
// Toggle modo claro/oscuro. Respeta ui-ux-pro-max: aria-label en bot√≥n solo-icono,
// cursor-pointer, focus-visible, contraste en ambos modos.
---

<button
  type="button"
  class="theme-toggle flex size-9 shrink-0 items-center justify-center rounded-md text-muted-foreground transition-colors hover:bg-muted hover:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background cursor-pointer touch-manipulation min-h-[44px] min-w-[44px]"
  aria-label="Activar modo oscuro"
  title="Alternar tema"
>
  <span data-icon="moon" class="theme-icon theme-icon-moon" aria-hidden="true">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />
    </svg>
  </span>
  <span data-icon="sun" class="theme-icon theme-icon-sun" aria-hidden="true">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="4" />
      <path d="M12 2v2" /><path d="M12 20v2" /><path d="m4.93 4.93 1.41 1.41" /><path d="m17.66 17.66 1.41 1.41" /><path d="M2 12h2" /><path d="M20 12h2" /><path d="m6.34 17.66-1.41 1.41" /><path d="m19.07 4.93-1.41 1.41" />
    </svg>
  </span>
</button>

<style>
  .theme-icon-moon { display: block; }
  .theme-icon-sun { display: none; }
  :global(.dark) .theme-icon-moon { display: none; }
  :global(.dark) .theme-icon-sun { display: block; }
</style>

<script>
  (function () {
    const btn = document.querySelector(".theme-toggle");
    if (!btn) return;

    function updateLabel() {
      const isDark = document.documentElement.classList.contains("dark");
      btn.setAttribute("aria-label", isDark ? "Activar modo claro" : "Activar modo oscuro");
    }

    updateLabel();

    btn.addEventListener("click", function () {
      const isDark = document.documentElement.classList.contains("dark");
      if (isDark) {
        document.documentElement.classList.remove("dark");
        try { localStorage.setItem("theme", "light"); } catch (_) {}
      } else {
        document.documentElement.classList.add("dark");
        try { localStorage.setItem("theme", "dark"); } catch (_) {}
      }
      updateLabel();
    });
  })();
</script>
